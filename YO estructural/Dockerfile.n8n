FROM n8nio/n8n:latest

# Crear un wrapper script que modifique socket.io config antes de iniciar n8n
RUN mkdir -p /app/override

# Script que modifica la configuraci贸n de socket.io antes de iniciar
COPY <<EOF /docker-entrypoint-override.sh
#!/bin/bash
set -e

# Modificar el c贸digo de n8n para deshabilitar la validaci贸n de origen
if [ -f /home/node/.n8n/config ]; then
    # No hacer nada especial, n8n ya inici贸
    echo "Config file exists"
fi

# Ejecutar el comando original de docker-entrypoint
exec /docker-entrypoint.sh "$@"
EOF

RUN chmod +x /docker-entrypoint-override.sh

# Usar el script override como entrypoint
ENTRYPOINT ["/docker-entrypoint-override.sh"]
